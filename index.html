<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Gallery</title>
    <style>
        .hidden { display: none; }
        .gallery-item { margin: 10px; border: 1px solid #ccc; padding: 5px; display: inline-block; vertical-align: top; }
        .gallery-item img { max-width: 150px; height: auto; display: block; margin-bottom: 5px; }
        #gallery-search { margin-bottom: 15px; padding: 8px; width: 300px; border: 1px solid #ddd; border-radius: 4px; }
        #image-count { font-weight: bold; margin-left: 10px; }
        body { font-family: sans-serif; padding: 20px; }
        h1 { color: #333; }
    </style>
</head>
<body>
    <h1>Image Gallery</h1>

    <div>
        <label for="gallery-search">Search Images:</label>
        <input type="text" id="gallery-search" placeholder="Filter by filename...">
        <span>Visible Images: <span id="image-count">0</span></span>
    </div>

    <div id="image-gallery">
        <div class="gallery-item">
            <img src="images/mountain-landscape.jpg" alt="Mountain Landscape">
            <span>mountain-landscape.jpg</span>
        </div>
        <div class="gallery-item">
            <img src="images/city-night.png" alt="Cityscape Night">
            <span>city-night.png</span>
        </div>
        <div class="gallery-item">
            <img src="images/forest-path.jpeg" alt="Forest Path">
            <span>forest-path.jpeg</span>
        </div>
        <div class="gallery-item">
            <img src="images/happy-dog.gif" alt="Happy Dog">
            <span>happy-dog.gif</span>
        </div>
        <div class="gallery-item">
            <img src="images/sleeping-cat.webp" alt="Sleeping Cat">
            <span>sleeping-cat.webp</span>
        </div>
        <div class="gallery-item">
            <img src="images/abstract-art.svg" alt="Abstract Art">
            <span>abstract-art.svg</span>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('gallery-search');
            const imageGallery = document.getElementById('image-gallery');
            const imageItems = imageGallery.querySelectorAll('.gallery-item');
            const imageCountSpan = document.getElementById('image-count');

            function updateImageCount() {
                let visibleCount = 0;
                imageItems.forEach(item => {
                    if (!item.classList.contains('hidden')) {
                        visibleCount++;
                    }
                });
                imageCountSpan.textContent = visibleCount;
            }

            // Initial count update
            updateImageCount();

            searchInput.addEventListener('input', (event) => {
                const searchTerm = event.target.value.toLowerCase();
                let currentVisibleCount = 0;

                imageItems.forEach(item => {
                    const img = item.querySelector('img');
                    const src = img.src;
                    
                    // Extract filename from src, handling paths, query parameters, and hash
                    let fullFilename = src.substring(src.lastIndexOf('/') + 1);
                    fullFilename = fullFilename.substring(fullFilename.lastIndexOf('\\') + 1); // For Windows paths
                    
                    const queryParamIndex = fullFilename.indexOf('?');
                    if (queryParamIndex !== -1) {
                        fullFilename = fullFilename.substring(0, queryParamIndex);
                    }
                    const hashIndex = fullFilename.indexOf('#');
                    if (hashIndex !== -1) {
                        fullFilename = fullFilename.substring(0, hashIndex);
                    }
                    
                    fullFilename = fullFilename.toLowerCase();

                    if (fullFilename.includes(searchTerm)) {
                        item.classList.remove('hidden');
                        currentVisibleCount++;
                    } else {
                        item.classList.add('hidden');
                    }
                });
                imageCountSpan.textContent = currentVisibleCount;
            });
        });
    </script>
</body>
</html>